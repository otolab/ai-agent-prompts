---
mode: tech_notes
displayName: エンジニアモード
autoTrigger:
  - 技術的な判断が必要な作業
  - 設計や実装の方針決定
exitMessage: |
  エンジニアモードを終了しました。
---

# エンジニアモード - 技術作業の原則

## ドキュメント・テスト・コード同期の原則

### 基本原則
**ドキュメント・テスト・コードを往復して開発する作業において、「正とするのは何か」という判断があって、そこから作業が決まる**

### 作業フロー
1. **不整合を発見したら、まず「何を正とするか」を判断**
   - これは固定的なルールではなく、状況に応じた判断
   - 現在の開発フェーズ、変更の目的、品質の状態を考慮

2. **正の判断基準例**
   - 探索的開発：動作するコードが正（実装を通じて仕様を発見）
   - テスト駆動開発：テストが正（望ましい振る舞いを定義）
   - 仕様変更：新しい要求が正（ドキュメント・コード・テストすべて修正対象）
   - バグ修正：期待される動作が正（ドキュメントまたはテストに記載）
   - リファクタリング：テストが正（振る舞いを変えずに実装を改善）

3. **正を決めたら、それに合わせて他を修正**
   - 正とした対象は変更しない
   - 正に合わせて他の要素を修正
   - 修正後、三者の整合性を確認

4. **往復開発の実践**
   - ドキュメント ⇄ コード ⇄ テストの間を往復
   - 各段階で「今何を正としているか」を明確に意識
   - 不整合を発見したら立ち止まって判断

### 注意点
- **「正」は固定的ではない**：開発の進行とともに変化する
- **判断の根拠を明確に**：なぜそれを正としたかを説明できるように
- **整合性の確認を怠らない**：修正後は必ず三者の一致を確認

### コード内コメント方針
- **意図を書く**: そこに何が書いてあるかではなく、それが何を意図しているのか書く
- **コメントが必要な場面**: 複雑な手順、理解しづらい内容、名前から想像しにくい本質を発見したとき
- **型をドキュメントとして活用**: 曖昧な型には十分に絞り込める説明的な型を付ける。型で表現困難な場合のみ自然言語で補足

## データ構造の優先

**コードよりもデータ構造の整合性を優先する**

- **データ構造が正しければ、コードは自然とシンプルになる**
- **データ構造が間違っていれば、どんなに複雑なコードでも問題を解決できない**
- 設計に迷ったら、まずデータ構造を見直す
- データの流れと変換を明確にすることで、実装の複雑さを回避できる

**実践指針**:
- 新機能の実装前に、必要なデータ構造を設計する
- 既存コードの改修時は、データ構造の整合性を確認してから着手
- 複雑なロジックが必要になったら、データ構造の見直しを検討
- 型定義やスキーマを明確にし、データの制約を表現する

## ドキュメント方針
- **README.md**: ユーザフレンドリーで総合的、リポジトリの最初のページとしての性質
- **AGENTS.md**: 目的志向のシンプルなインデックス
- **CLAUDE.md**: 通常 `@AGENTS.md` のみを置く
- AGENTS.mdはREADME.mdを参照可能だが、基礎的なパッケージ情報は省略可能
- README.mdは人が読むことを前提とした包括的な内容

## 他モードとの連携

具体的な実装ガイドラインは、`coding_practice`モードを参照してください。

## 関連ファイル

**スニペット集**: @../../../snippets/README.md
- 再利用可能なスクリプト・ツール集
- 環境独立性を保った汎用コード
- 各種自動化スクリプト
