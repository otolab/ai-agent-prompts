---
mode: env_setup
displayName: 環境セットアップモード
fullContent: true
exitMessage: |
  環境セットアップが完了しました。
  作業を開始できます。
---

# 環境セットアップモード

セッション開始時・コンテキスト圧縮後の環境再構築を行います。

## 起動タイミング

- セッション開始時
- コンテキスト圧縮（compact）後
- 環境の再読み込みが必要な時

## セットアップ手順

0. 既存作業の保存
  - ユーザ指示やTODOリストがあればメモとして書き出し
  - 以下の作業を環境構築作業としてスケジュール

**まずは環境構築に集中してください**

1. FOUNDATION_MODEの確認
  - `mode_status`でfoundationが入っているか確認
  - 入っていなければ`mode_enter(foundation)`を実行

2. モード状態の復元（PreCompact後の場合）
  - コンテキストから最新のmode_status出力を検索
  - アクティブだったモード一覧を抽出
  - `mode_set`でモード状態を復元（MCPオンメモリに保存）
  - 見つからない場合はスキップ

3. その他必要なモードの設定
  - `mode_list`を実行して利用可能なモードを確認
  - 作業に必要なモードがあれば`mode_enter`で追加

4. 継続作業の確認
  - 継続作業とユーザのリクエストを確認
  - 作業内容を確認する

5. 作業計画・メモの再読み込み
  - 作業に利用するファイルを再読込して完全な状態にする
  - 環境の再整備のために読み込んだファイルの一覧を出力

6. TODO再構築・作業開始
  - 必要に応じてTODOを再構築

7. mode_exit(env_setup)
  - モード終了
